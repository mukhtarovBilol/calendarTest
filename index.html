<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Выбор дат</title>
</head>
<body>
    <label for="start_date">Дата начала:</label>
    <input type="date" id="start_date">

    <label for="end_date">Дата возврата:</label>
    <input type="date" id="end_date">

    <button id="submitButton" disabled>Подтвердить</button>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var today = new Date();
            var todayString = today.toISOString().split('T')[0];
            document.getElementById("start_date").value = todayString;
            document.getElementById("start_date").min = todayString;

            updateEndDateMin(today);
        });

        document.getElementById("start_date").addEventListener("change", function () {
            var startDate = new Date(this.value);
            if (startDate < new Date()) {
                alert("Нельзя выбирать прошлые даты.");
                this.value = ''; // Сбрасываем значение
                return;
            }
            updateEndDateMin(startDate);
            document.getElementById("end_date").value = ''; // Сбрасываем значение end_date
            checkButtonState();
        });

        function updateEndDateMin(startDate) {
            var twoDaysLater = new Date(startDate);
            twoDaysLater.setDate(startDate.getDate() + 2);
            var minEndDate = twoDaysLater.toISOString().split('T')[0];
            document.getElementById("end_date").setAttribute('min', minEndDate);
        }

        document.getElementById("end_date").addEventListener("change", function() {
            var startDate = new Date(document.getElementById("start_date").value);
            var minEndDate = new Date(startDate);
            minEndDate.setDate(startDate.getDate() + 2);

            // Проверяем, что дата возврата выбрана и соответствует минимально допустимой
            if (this.value) {
                var selectedEndDate = new Date(this.value);
                if (selectedEndDate < minEndDate) {
                    alert("Дата возврата должна быть минимум на 2 дня позже даты начала.");
                    this.value = ''; // Сбрасываем значение
                    return; // Позволяет пользователю снова выбрать дату
                }
            }

            checkButtonState();
        });

        function checkButtonState() {
            var startDate = document.getElementById("start_date").value;
            var endDate = document.getElementById("end_date").value;
            var isButtonEnabled = startDate && endDate;
            document.getElementById("submitButton").disabled = !isButtonEnabled;
        }
    </script>
</body>
</html>
