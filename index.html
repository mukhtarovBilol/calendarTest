<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Выбор дат</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <label for="start_date">Дата начала:</label>
    <input type="date" id="start_date">

    <label for="end_date">Дата возврата:</label>
    <input type="date" id="end_date">

    <button id="submitButton" disabled>Подтвердить</button>

    <script>
        $(document).ready(function() {
            // Устанавливаем сегодняшнюю дату как значение и минимальную для start_date
            const today = new Date();
            const todayString = today.toISOString().split('T')[0];
            $('#start_date').attr('min', todayString).val(todayString);

            // Устанавливаем минимальную дату для end_date на 2 дня позже
            updateEndDateMin(today);

            $('#start_date').change(function() {
                const startDate = new Date($(this).val());
                if (startDate < today) {
                    alert("Нельзя выбирать прошлые даты.");
                    $(this).val(todayString); // Возвращаем к сегодняшней
                    return;
                }
                updateEndDateMin(startDate);
                $('#end_date').val(''); // Сбрасываем end_date
                checkButtonState();
            });

            $('#end_date').change(function() {
                const startDate = new Date($('#start_date').val());
                const minEndDate = new Date(startDate);
                minEndDate.setDate(startDate.getDate() + 2);

                if ($(this).val()) {
                    const selectedEndDate = new Date($(this).val());
                    if (selectedEndDate < minEndDate) {
                        alert("Дата возврата должна быть минимум на 2 дня позже даты начала.");
                        $(this).val(''); // Сбрасываем значение
                    }
                }
                checkButtonState();
            });

            function updateEndDateMin(startDate) {
                const twoDaysLater = new Date(startDate);
                twoDaysLater.setDate(startDate.getDate() + 2);
                const minEndDate = twoDaysLater.toISOString().split('T')[0];
                $('#end_date').attr('min', minEndDate);
            }

            function checkButtonState() {
                const startDate = $('#start_date').val();
                const endDate = $('#end_date').val();
                $('#submitButton').prop('disabled', !(startDate && endDate));
            }
        });
    </script>
</body>
</html>
